<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.domain.community.mapper.CmntTagMapper">
     
     <resultMap id="NTResultMap" type="com.example.demo.domain.community.entity.NormalTag">
        <result column="normal_tag_sq" property="normalTagSq"/>
	    <result column="board_sq" property="boardSq"/>
        <result column="answer_sq" property="answerSq"/>
        <result column="normal_tag_nm" property="normalTagNm"/>
        <result column="normal_tag_type_cd" property="normalTagTypeCd"/>
	  </resultMap>
     
     <resultMap id="STResultMap" type="com.example.demo.domain.community.entity.SkillTag">
        <result column="board_skill_tag_sq" property="boardSkillTagSq"/>
	    <result column="board_sq" property="boardSq"/>
        <result column="answer_sq" property="answerSq"/>
        <result column="skill_tag_sq" property="skillTagSq"/>
        <result column="skill_tag_nm" property="skillTagNm"/>
        <result column="skill_tag_type_cd" property="skillTagTypeCd"/>
	  </resultMap>

    <select id="findNT" resultMap="NTResultMap">
        SELECT * FROM TBL_BOARD_NORMAL_TAG_S
        
        <if test="boardSq != null">
        	WHERE board_sq = #{boardSq}
	    </if>
        <if test="answerSq != null">
        	WHERE answer_sq = #{answerSq}
	    </if>
	    
    </select>

    <insert id="insertNT" parameterType="List" useGeneratedKeys="true" keyProperty="normalTagSq">
        INSERT INTO TBL_BOARD_NORMAL_TAG_S (board_sq, answer_sq, normal_tag_nm, normal_tag_type_cd) 
        VALUES
        <foreach collection="normalTags" item="tag" separator=",">
        	(#{tag.boardSq}, #{tag.answerSq}, #{tag.normalTagNm}, #{tag.normalTagTypeCd})
        </foreach> 
    </insert>

    <delete id="deleteNT" parameterType="com.example.demo.domain.community.entity.NormalTag">
        DELETE FROM TBL_BOARD_NORMAL_TAG_S
        
        <if test="boardSq != null">
        	WHERE board_sq = #{boardSq}
	    </if>
        <if test="answerSq != null">
        	WHERE answer_sq = #{answerSq}
	    </if>
    </delete>
    
    <select id="findST" resultMap="STResultMap">
        SELECT * FROM TBL_BOARD_SKILL_TAG_S
        
        <if test="boardSq != null">
        	WHERE board_sq = #{boardSq}
	    </if>
        <if test="answerSq != null">
        	WHERE answer_sq = #{answerSq}
	    </if>
    </select>

    <insert id="insertST" parameterType="List" useGeneratedKeys="true" keyProperty="skillTagSq">
        INSERT INTO TBL_BOARD_SKILL_TAG_S (board_sq, answer_sq, skill_tag_sq, skill_tag_nm, skill_tag_type_cd) 
        VALUES
        <foreach collection="skillTags" item="tag" separator=",">
        	(#{tag.boardSq}, #{tag.answerSq}, #{tag.skillTagSq}, #{tag.skillTagNm}, #{tag.skillTagTypeCd})
        </foreach> 
    </insert>

    <delete id="deleteST" parameterType="com.example.demo.domain.community.entity.SkillTag">
        DELETE FROM TBL_BOARD_SKILL_TAG_S
        
        <if test="boardSq != null">
        	WHERE board_sq = #{boardSq}
	    </if>
        <if test="answerSq != null">
        	WHERE answer_sq = #{answerSq}
	    </if>
    </delete>

</mapper>